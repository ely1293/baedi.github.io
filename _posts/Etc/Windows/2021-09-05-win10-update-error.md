---
layout: post
title:  "윈도우10 21H1 업데이트 0x20017 에러 해결 후기"
date:   2021-09-05 17:14:30 +0530
comments: true
categories: [Etc, Windows]
---

데스크톱에 윈도우10으로 잘 이용하고 있다가 최근에 윈도우 업데이트에서 문제가 발견한 것을 확인하였다.   

윈도우 업데이트를 확인해보니 "장치에 중요한 보안 및 품질 수정이 누락되어 있습니다." 라는 메시지가 나타났던 것이었다.   

보안 문제 때문에 윈도우10을 최신버전으로 항상 업데이트를 해주어야 하는데 업데이트가 진행되지 않아서 난감했었는데 현재 쓰고 있는 윈도우10 버전을 확인해보니 필자는 1909 버전을 사용중이었다. 게다가 현재 이 버전은 이미 2021년 5월 11일에 서비스가 종료되었다는 사실도 이제서야 알게 되었다.   


![windows_10_update_failed](https://baedi.github.io/assets/post/20210905_03_01_update_failed.png)   

그래서 보안 업데이트를 계속 받기 위해서는 최소한 그 이상의 윈도우10 버전을 받아야만 하였다. 일단 윈도우 업데이트에서 받는 것을 계속 시도해보았지만 같은 메시지만 되풀이되고 있어서 수동으로 직접 받아보기로 하였다.   

윈도우10 업데이트는 아래 사이트에 방문하여 받을 수 있었다.   
<https://www.microsoft.com/ko-kr/software-download/windows10>   

이 포스트를 작성한 기준으로 윈도우10 최신 버전은 21H1 버전이어서 해당 버전을 다운로드받을 수 있었다. 그리고 그 파일을 통해서 업데이트를 설치할 수 있었는데 바로 해당 PC에서 업데이트를 진행하거나 아니면 USB에 담아서 부팅하여 업데이트를 진행할 수 있었다.   


일단 처음에는 첫번째 방법으로 바로 업데이트를 진행하였는데 설치 완료되고 부팅 후 윈도우 업데이트가 진행되는가 했더니 부팅 중 나오는 바이오스 로고 화면이 나오고 1초 뒤에 바로 꺼졌다가 재부팅되는 현상을 보게 되었다.   


![windows_10_update_failed2](https://baedi.github.io/assets/post/20210905_03_02_update_failed.png)   

결과는 위 화면처럼 0xC1900101 - 0x20017 에러코드와 함께 설치가 실패했다는 창을 보게 되었다.   

그래서 해당 에러 원인을 확인해보니 외부 드라이버나 타사 프로그램의 영향 때문에 발생했을 가능성이 높은 걸 보고 불필요하게 연결된 USB 장치들을 다 해제하고 마이크로소프트에서 알려준 방법대로 그래픽카드, 프로세서 등 장치들의 드라이버 버전이 최신인지를 확인하고 서비스를 이것저것 내려보고 USB까지 여러 번 설치를 해보았다.   

심지어는 설치된 시스템이랑 개인 파일들을 전부 하드디스크에 백업시켜두고 클린 상태로 업데이트까지 여러 번 시도해보았지만 계속 실패했었다. 이상하게도 USB에 윈도우10을 굽고 부팅하면 바이오스 로고가 등장하고 1초 뒤에 화면이 깨지는 현상이 계속 발생했었다. 이것은 최근 구매했었던 윈도우10 정품 USB로 했을 경우에도 상황이 크게 다르지 않았었다.   

그런데 2019년 이전 윈도우10 USB로는 잘 동작하던 것이었다. 상황이 여기까지 오게되면서부터 하드웨어 쪽에 문제가 생긴게 아닌가 생각이 들었지만 일단 하드웨어 쪽은 최대한 건들지 않고 업데이트를 해보기로 마음먹어서 최대한 할 수 있는 다른 방법들을 계속 찾아보았다.   


![windows_10_update_failed3](https://baedi.github.io/assets/post/20210905_03_03_update_failed.png)   

혹시나 21H1 업데이트에 필요한 다른 업데이트를 진행하지 않아서 발생된 것인가 해서 계속 업데이트에 실패했던 것이 아닌가 하는 생각에 마이크로소프트 업데이트 카탈로그 사이트에 방문하여 해당 버전을 수동으로 받아보고 안전모드까지 전환하면서 수동 설치를 진행하였지만 여전히 실패했었다.   

그래서 이제 필자가 직접 할 수 있는 마지막 방법으로는 메인보드의 바이오스를 업데이트하는 방법 밖에 없었다. 아무래도 USB 인식오류랑 윈도우 업데이트 버전에 따라 제대로 동작하거나 안 되는 것을 보니 메인보드와 관련하여 최신 버전의 윈도우를 제대로 인식 못해서 발생한 문제가 아니었나 생각했었다.   


일단 필자의 메인보드는 MSI A320M PRO-VD PLUS를 사용중이고 아직 한 번도 바이오스를 업데이트한 적이 없었다. 3년동안 썼으니 당연하게도 꽤 오래된 2018년 3월에 릴리즈된 버전을 사용중이었다. 바이오스를 업데이트하지 않았던 이유는 업데이트 이후 벽돌이 되었다는 사례를 꽤 봤었고 그동안 업데이트 없이 잘 써왔었기 때문에 굳이 업그레이드를 해야 할 필요성을 못 느꼈었다.   

그러나 이번에 윈도우 업데이트가 안 되면서 불가피하게 바이오스를 업데이트해야 할 것 같아서 아래 링크 영상을 참고하여 바이오스 업데이트를 진행했었다.   

<https://www.youtube.com/watch?v=T9eQSRqE2mY>   


![bios_before](https://baedi.github.io/assets/post/20210905_03_04_bios_before.png)   

먼저 확인한 것은 바이오스에 진입하여 바이오스 버전을 확인하는 것이었다. 설치 전에 사용했던 버전은 7B38v18 임을 확인하고 MSI 코리아 사이트에 접속하여 사용중인 마더보드를 검색하고 설치받을 수 있는 바이오스 업데이트 버전을 확인할 수 있었다.   


![msi_driver_search](https://baedi.github.io/assets/post/20210905_03_05_msi_driver_search.png)   

먼저 아래 사이트에 접속하여 드라이버를 다운로드할 제품을 검색하였다. 현재 사용중인 마더보드의 기종을 확인하였는데 필자의 경우 본체의 마더보드에 모델명이 적혀있어서 훨씬 쉽게 찾아낼 수 있었다.   

MSI 코리아 드라이버 다운로드 제품 검색 : <https://kr.msi.com/support/download/mb>   


![bios_recent_version_dw](https://baedi.github.io/assets/post/20210905_03_06_bios_recent_version_dw.png)   
![bios_current_version_dw](https://baedi.github.io/assets/post/20210905_03_07_bios_current_version_dw.png)   

그 후 해당 기종에서 BIOS 탭을 눌러 확인해보니 현재 올라온 최신버전은 2020년 7월에 올라온 베타버전이었다. 그리고 현재 필자가 사용중인 버전과 비교하여 확인해보니 그 사이에 올라왔던 버전이 6개 정도 있었다.   

최신버전으로 바로 업그레이드를 해야 될 것 같아서 업데이트 시 주의사항을 구글링해서 찾아보았는데 최신버전으로 업데이트할 때 그 이전에 올라왔던 업데이트 버전을 하나씩 확인해야 된다고 하여 확인해보니 올라온 버전 중 하나에서 AMD 칩셋 드라이버를 18.10 이상 업데이트를 권장하는 내용이 있었다.   

칩셋 드라이버는 이미 최신버전이 설치되어있어서 바로 최신버전을 다운로드받고 압축을 풀어서 나온 폴더 하나를 USB에 넣고 바이오스 설정의 M-Flash 모드를 열었다. 이걸로 다운로드받은 드라이버파일을 선택하여 바이오스 업데이트를 진행했다.   


![bios_update](https://baedi.github.io/assets/post/20210905_03_08_bios_update.png)   

바이오스 업데이트를 진행하는데 설치 도중에 전원을 끄거나 USB를 제거하면 절대 안 된다고 한다. 만약 그랬을 경우 벽돌이 될 가능성이 커진다고 한다.   
바이오스가 약 90% 정도 완료되었을 때 갑자기 화면이 꺼져서 처음에 깜짝 놀랐는데 2번 정도 부팅되고 정상적으로 윈도우가 돌아가는 걸 보니 별 문제 없이 업데이트가 된 것 같았다.   

![system_info](https://baedi.github.io/assets/post/20210905_03_09_system_info.png)   

업데이트가 정상적으로 되었는지 시스템 정보에서 확인해보니 바이오스 버전의 년도가 2020-07-01로 찍힌 것을 보아 바이오스 설치는 성공적이었다.   

이제 다시 수동으로 다운로드받았던 윈도우 21H1 설치파일로 업데이트를 설치하였고 업데이트 완료 후 부팅이 되었는데 이번엔 중간에 꺼지지 않고 정상적으로 업데이트 진행이 잘 이루어졌었다.   


![update_success1](https://baedi.github.io/assets/post/20210905_03_10_update_success.png)   
![update_success2](https://baedi.github.io/assets/post/20210905_03_11_update_success.png)   

이틀 동안 여러가지 삽질한 끝에 윈도우를 1909에서 21H1 버전으로 성공적으로 업데이트를 성공하고 나머지 남은 업데이트까지 받아서 윈도우를 최신 버전으로 유지할 수 있었다. 앞으로도 이런 드라이버 관련한 문제가 발생한다면 바이오스가 최신버전이 아닌지도 잘 확인해봐야 할 듯. 아무튼 AS없이 업데이트 문제를 해결할 수 있어서 다행이었다. 이제 다시 맘 놓고 코딩에 집중할 수 있을듯!   
